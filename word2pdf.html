<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word to PDF Converter - engineering_rule</title>

<!-- pdfmake -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<!-- mammoth.js for Word parsing -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.14/mammoth.browser.min.js"></script>

<style>
  body {
    background: #eee;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    min-height: 100vh;
    gap: 20px;
  }
  .brand { font-size: 20px; font-weight: bold; margin-bottom: -10px; }
  .main-heading {
    font-size: 32px;
    font-weight: bold;
    text-align: center;
    background-image: linear-gradient(90deg, blue, red);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent;
    transition: all 0.5s ease-in-out;
  }
  .main-heading:hover { transform: scale(1.05); }
  .neumorphic-card {
    background: #eee;
    border-radius: 20px;
    box-shadow: 10px 10px 20px #a3b1c6, -10px -10px 20px #ffffff;
    padding: 30px;
    width: 100%;
    max-width: 500px;
    text-align: center;
  }
  .neumorphic-input {
    width: 100%;
    margin: 15px 0;
    padding: 12px;
    border-radius: 15px;
    border: none;
    outline: none;
    box-shadow: inset 5px 5px 10px #a3b1c6, inset -5px -5px 10px #ffffff;
    background: #eee;
  }
  .neumorphic-button {
    padding: 15px;
    width: 70%;
    max-width: 200px;
    border-radius: 15px;
    border: none;
    cursor: pointer;
    background: #eee;
    font-weight: bold;
    box-shadow: 5px 5px 10px #a3b1c6, -5px -5px 10px #ffffff;
    transition: all 0.2s ease-in-out;
  }
  .neumorphic-button:active {
    box-shadow: inset 5px 5px 10px #a3b1c6, inset -5px -5px 10px #ffffff;
  }
</style>
</head>
<body>

<div class="brand">engineering_rule</div>
<div class="main-heading">Word to PDF Converter</div>

<div class="neumorphic-card">
  <input type="file" id="wordFile" class="neumorphic-input" accept=".docx">
  <button class="neumorphic-button" onclick="convertWordToPDF()">Convert to PDF</button>
</div>

<script>
function convertWordToPDF() {
  const fileInput = document.getElementById('wordFile');
  if (!fileInput.files.length) {
    alert("Please select a Word file!");
    return;
  }

  const file = fileInput.files[0];

  const reader = new FileReader();
  reader.onload = function(event) {
    const arrayBuffer = event.target.result;

    mammoth.extractRawText({ arrayBuffer: arrayBuffer })
      .then(result => {
        const text = result.value.trim();
        if (!text) {
          alert("Word file is empty or unsupported content!");
          return;
        }

        const docDefinition = {
          content: [{ text: text, fontSize: 12 }],
          header: { text: 'Word to PDF - engineering_rule', alignment: 'center', fontSize: 10, margin: [0,10,0,10] },
          footer: function(currentPage, pageCount) {
            return { text: currentPage.toString() + ' / ' + pageCount, alignment: 'center', fontSize: 10, margin: [0,10,0,0] };
          },
          pageMargins: [40,60,40,60]
        };

        pdfMake.createPdf(docDefinition).download("output.pdf");
      })
      .catch(err => {
        console.error(err);
        alert("Error reading Word file.");
      });
  };
  reader.readAsArrayBuffer(file);
}
</script>
</body>
</html>
